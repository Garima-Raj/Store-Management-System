{% extends 'core/base.html' %}

{% block title %}Order #{{ order.id }}{% endblock %}

{% block content %}
    <h1>Order #{{ order.id }}</h1>

    <div class="row mb-4">
        <div class="col-md-6">
            <p><strong>Placed on:</strong> {{ order.created_at|date:"d M Y, H:i" }}</p>
            <p><strong>Status:</strong> 
                <span class="badge 
                    {% if order.status == 'pending' %}bg-warning{% elif order.status == 'delivered' %}bg-success{% else %}bg-info{% endif %}">
                    {{ order.status|capfirst }}
                </span>
            </p>
            <p><strong>Total:</strong> ₹{{ order.total_amount }}</p>
            {% if order.notes %}
                <p><strong>Notes:</strong> {{ order.notes }}</p>
            {% endif %}
        </div>
        <div class="col-md-6">
            <p><strong>Shipping Address:</strong><br>{{ order.shipping_address|linebreaks }}</p>
        </div>
    </div>

    <h3>Items</h3>
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Product</th>
                <th>Price (at purchase)</th>
                <th>Quantity</th>
                <th>Subtotal</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
                <tr>
                    <td>{{ item.product.name }}</td>
                    <td>₹{{ item.price_at_purchase }}</td>
                    <td>{{ item.quantity }}</td>
                    <td>₹{{ item.price_at_purchase|floatformat:2|multiply:item.quantity }}</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <a href="{% url 'order_history' %}" class="btn btn-secondary mt-3">Back to My Orders</a>
{% endblock %}